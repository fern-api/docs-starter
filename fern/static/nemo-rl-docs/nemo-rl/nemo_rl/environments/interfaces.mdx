---
layout: overview
slug: nemo-rl/nemo_rl/environments/interfaces
title: nemo_rl.environments.interfaces
---

## Module Contents

### Classes

| Name | Description |
|------|-------------|
| [`EnvironmentInterface`](#nemo_rl-environments-interfaces-EnvironmentInterface) | - |
| [`EnvironmentReturn`](#nemo_rl-environments-interfaces-EnvironmentReturn) | Standard batched return type for environment step methods. |

### Data

[`MetadataT`](#nemo_rl-environments-interfaces-MetadataT)

### API

<Anchor id="nemo_rl-environments-interfaces-EnvironmentInterface">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
class nemo_rl.environments.interfaces.EnvironmentInterface()
```

</CodeBlock>
</Anchor>

<Indent>

<Badge>Abstract</Badge>

**Bases:** `ABC`, `Generic[MetadataT]`

<Anchor id="nemo_rl-environments-interfaces-EnvironmentInterface-global_post_process_and_metrics">

<CodeBlock links={{"nemo_rl.distributed.batched_data_dict.BatchedDataDict":"/nemo-rl/nemo_rl/distributed/batched_data_dict#nemo_rl-distributed-batched_data_dict-BatchedDataDict"}} showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.environments.interfaces.EnvironmentInterface.global_post_process_and_metrics(
    batch: nemo_rl.distributed.batched_data_dict.BatchedDataDict
) -> tuple[nemo_rl.distributed.batched_data_dict.BatchedDataDict, dict]
```

</CodeBlock>
</Anchor>

<Indent>

<Badge>abstract</Badge>

Post processing function after all rollouts are done for the batch and returns metrics.


</Indent>
<Anchor id="nemo_rl-environments-interfaces-EnvironmentInterface-step">

<CodeBlock links={{"nemo_rl.data.interfaces.LLMMessageLogType":"/nemo-rl/nemo_rl/data/interfaces#nemo_rl-data-interfaces-LLMMessageLogType","nemo_rl.environments.interfaces.MetadataT":"#nemo_rl-environments-interfaces-MetadataT","nemo_rl.environments.interfaces.EnvironmentReturn":"#nemo_rl-environments-interfaces-EnvironmentReturn"}} showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.environments.interfaces.EnvironmentInterface.step(
    message_log_batch: list[nemo_rl.data.interfaces.LLMMessageLogType],
    metadata: list[nemo_rl.environments.interfaces.MetadataT]
) -> nemo_rl.environments.interfaces.EnvironmentReturn[nemo_rl.environments.interfaces.MetadataT]
```

</CodeBlock>
</Anchor>

<Indent>

<Badge>abstract</Badge>

Runs a step in the environment. Allows for asynchrony with remote servers, but it's not required (this function is a ray remote).

metadata:     batch of whatever the environment needs to keep track of. I.e.
              math solutions, code unit tests, or agent states. Can be None if episode terminated.

Returns:
- EnvironmentReturn NamedTuple containing observations, metadata, next_stop_strings, rewards, and terminateds flags.


</Indent>
</Indent>

<Anchor id="nemo_rl-environments-interfaces-EnvironmentReturn">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
class nemo_rl.environments.interfaces.EnvironmentReturn()
```

</CodeBlock>
</Anchor>

<Indent>

**Bases:** `NamedTuple`, `Generic[MetadataT]`

Standard batched return type for environment step methods.

**All elements are batched.**
observations: New observation from the environment.
              It's a (batched) 'message' type, which is a dict
              with keys 'role' and 'content'.
metadata: Updated metadata from the environment.
next_stop_strings: The stop strings for the next turn.
                   If your environment is a game or similar,
                   you may want to return a list of stop strings
                   that are valid actions for the next turn or
                   similar. This field lets you control this per turn.
rewards: the rewards for this turn.
terminateds: whether the episode ended this turn.
answers: the answers for this turn.


<ParamField path="answers" type="list[str | None] | None">
</ParamField>

<ParamField path="metadata" type="list[MetadataT]">
</ParamField>

<ParamField path="next_stop_strings" type="list[list[str] | None] | list[None]">
</ParamField>

<ParamField path="observations" type="list[dict[str, str]]">
</ParamField>

<ParamField path="rewards" type="Tensor">
</ParamField>

<ParamField path="terminateds" type="Tensor">
</ParamField>
</Indent>

<Anchor id="nemo_rl-environments-interfaces-MetadataT">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.environments.interfaces.MetadataT = TypeVar('MetadataT')
```

</CodeBlock>
</Anchor>

