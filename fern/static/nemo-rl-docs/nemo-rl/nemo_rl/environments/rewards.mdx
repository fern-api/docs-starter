---
layout: overview
slug: nemo-rl/nemo_rl/environments/rewards
title: nemo_rl.environments.rewards
---

## Module Contents

### Functions

| Name | Description |
|------|-------------|
| [`bbox_giou_reward`](#nemo_rl-environments-rewards-bbox_giou_reward) | Given [x1, y1, x2, y2] normalized bounding box coordinates within the &lt;&#123;answer_tag&#125;&gt; tags, compute the GIoU between the ground truth and the response. |
| [`combine_reward_functions`](#nemo_rl-environments-rewards-combine_reward_functions) | Returns a callable function that takes (ground_truth, response) and collects multiple reward functions in sequence. |
| [`exact_answer_alphanumeric_reward`](#nemo_rl-environments-rewards-exact_answer_alphanumeric_reward) | Reward the agent when the answer within the &lt;&#123;answer_tag&#125;&gt; tags is the same as the ground truth (case-insensitive). |
| [`format_reward`](#nemo_rl-environments-rewards-format_reward) | Reward the agent when the response follows the format: (.*) &lt;think&gt; (.*) &lt;/think&gt; &lt;answer&gt; (.*) &lt;/answer&gt;. |
| [`math_expression_reward`](#nemo_rl-environments-rewards-math_expression_reward) | Reward the agent when the answer within the &lt;&#123;tag&#125;&gt; tags is the same expression as the ground truth. |

### Data

[`boxed`](#nemo_rl-environments-rewards-boxed)

[`math_verify_func`](#nemo_rl-environments-rewards-math_verify_func)

### API

<Anchor id="nemo_rl-environments-rewards-bbox_giou_reward">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.environments.rewards.bbox_giou_reward(
    ground_truth: str,
    response: str,
    giou_penalty_thres: float = 10.0,
    answer_tag: str = 'answer'
) -> tuple[float, bool]
```

</CodeBlock>
</Anchor>

<Indent>

Given [x1, y1, x2, y2] normalized bounding box coordinates within the &lt;&#123;answer_tag&#125;&gt; tags, compute the GIoU between the ground truth and the response.

The `answer_tag` is customizable and must be specified as part of the user COT prompt text file.


</Indent>

<Anchor id="nemo_rl-environments-rewards-combine_reward_functions">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.environments.rewards.combine_reward_functions(
    reward_functions: list[tuple[typing.Callable[[str, str], tuple[float, bool]], float]]
) -> typing.Callable[[str, str], tuple[float, bool]]
```

</CodeBlock>
</Anchor>

<Indent>

Returns a callable function that takes (ground_truth, response) and collects multiple reward functions in sequence.

The reward functions are weighted by the second element of the tuple.
This information can be provided in the YAML config file and resolved in the VLMEnvironment class.

**Parameters:**

<ParamField path="reward_functions" type="list[tuple[Callable[[str, str], tuple[float, bool]], float]]">
list[tuple[Callable[[str, str], tuple[float, bool]], float]]. A list of reward functions and their weights.
</ParamField>

**Returns:** `Callable[[str, str], tuple[float, bool]]`

Callable[[str, str], tuple[float, bool]]: A callable function that takes (ground_truth, response) and collects multiple reward functions in sequence


</Indent>

<Anchor id="nemo_rl-environments-rewards-exact_answer_alphanumeric_reward">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.environments.rewards.exact_answer_alphanumeric_reward(
    ground_truth: str,
    response: str,
    answer_tag: str = 'answer'
) -> tuple[float, bool]
```

</CodeBlock>
</Anchor>

<Indent>

Reward the agent when the answer within the &lt;&#123;answer_tag&#125;&gt; tags is the same as the ground truth (case-insensitive).

The `answer_tag` is customizable and must be specified as part of the user COT prompt text file.


</Indent>

<Anchor id="nemo_rl-environments-rewards-format_reward">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.environments.rewards.format_reward(
    ground_truth: str,
    response: str,
    think_tag: str = 'think',
    answer_tag: str = 'answer'
) -> tuple[float, typing.Optional[bool]]
```

</CodeBlock>
</Anchor>

<Indent>

Reward the agent when the response follows the format: (.*) &lt;think&gt; (.*) &lt;/think&gt; &lt;answer&gt; (.*) &lt;/answer&gt;.

The `think_tag` and `answer_tag` are customizable and must be specified as part of the user COT prompt text file.


</Indent>

<Anchor id="nemo_rl-environments-rewards-math_expression_reward">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.environments.rewards.math_expression_reward(
    ground_truth: str,
    response: str,
    tag: str = 'answer'
) -> tuple[float, bool]
```

</CodeBlock>
</Anchor>

<Indent>

Reward the agent when the answer within the &lt;&#123;tag&#125;&gt; tags is the same expression as the ground truth.

The `tag` is customizable and must be specified as part of the user COT prompt text file.


</Indent>

<Anchor id="nemo_rl-environments-rewards-boxed">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.environments.rewards.boxed = lambda x: '\\boxed{' + x + '}' if not x.startswith('\\boxed{') else x
```

</CodeBlock>
</Anchor>


<Anchor id="nemo_rl-environments-rewards-math_verify_func">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.environments.rewards.math_verify_func = math_metric(gold_extraction_target=(LatexExtractionConfig(),), pred_extraction_t...
```

</CodeBlock>
</Anchor>

