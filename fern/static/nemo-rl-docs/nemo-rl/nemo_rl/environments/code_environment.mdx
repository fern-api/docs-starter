---
layout: overview
slug: nemo-rl/nemo_rl/environments/code_environment
title: nemo_rl.environments.code_environment
---

## Module Contents

### Classes

| Name | Description |
|------|-------------|
| [`CodeEnvConfig`](#nemo_rl-environments-code_environment-CodeEnvConfig) | - |
| [`CodeEnvMetadata`](#nemo_rl-environments-code_environment-CodeEnvMetadata) | - |
| [`CodeEnvironment`](#nemo_rl-environments-code_environment-CodeEnvironment) | Code execution environment that maintains state between steps. |
| [`CodeExecutionWorker`](#nemo_rl-environments-code_environment-CodeExecutionWorker) | Helper class to process individual code execution steps. |

### API

<Anchor id="nemo_rl-environments-code_environment-CodeEnvConfig">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
class nemo_rl.environments.code_environment.CodeEnvConfig
```

</CodeBlock>
</Anchor>

<Indent>

**Bases:** `typing.TypedDict`

<ParamField path="num_workers" type="int">

</ParamField>

<ParamField path="terminate_on_evaluation" type="bool">

</ParamField>

</Indent>

<Anchor id="nemo_rl-environments-code_environment-CodeEnvMetadata">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
class nemo_rl.environments.code_environment.CodeEnvMetadata
```

</CodeBlock>
</Anchor>

<Indent>

**Bases:** `typing.TypedDict`

<ParamField path="context" type="Dict[str, Any]">

</ParamField>

<ParamField path="working_dir" type="str">

</ParamField>

</Indent>

<Anchor id="nemo_rl-environments-code_environment-CodeEnvironment">

<CodeBlock links={{"nemo_rl.environments.code_environment.CodeEnvConfig":"#nemo_rl-environments-code_environment-CodeEnvConfig"}} showLineNumbers={false} wordWrap={true}>

```python
class nemo_rl.environments.code_environment.CodeEnvironment(
    cfg: nemo_rl.environments.code_environment.CodeEnvConfig
)
```

</CodeBlock>
</Anchor>

<Indent>

**Bases:** [EnvironmentInterface](/nemo-rl/nemo_rl/environments/interfaces#nemo_rl-environments-interfaces-EnvironmentInterface)

Code execution environment that maintains state between steps.


<ParamField path="num_workers" type="= cfg['num_workers']">
</ParamField>

<ParamField path="terminate_on_evaluation" type="= cfg['terminate_on_evaluation']">
</ParamField>

<ParamField path="workers">
</ParamField>
<Anchor id="nemo_rl-environments-code_environment-CodeEnvironment-global_post_process_and_metrics">

<CodeBlock links={{"nemo_rl.distributed.batched_data_dict.BatchedDataDict":"/nemo-rl/nemo_rl/distributed/batched_data_dict#nemo_rl-distributed-batched_data_dict-BatchedDataDict"}} showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.environments.code_environment.CodeEnvironment.global_post_process_and_metrics(
    batch: nemo_rl.distributed.batched_data_dict.BatchedDataDict
) -> typing.Tuple[nemo_rl.distributed.batched_data_dict.BatchedDataDict, dict]
```

</CodeBlock>
</Anchor>

<Indent>

Compute metrics for the batch.


</Indent>
<Anchor id="nemo_rl-environments-code_environment-CodeEnvironment-shutdown">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.environments.code_environment.CodeEnvironment.shutdown()
```

</CodeBlock>
</Anchor>

<Indent>


</Indent>
<Anchor id="nemo_rl-environments-code_environment-CodeEnvironment-step">

<CodeBlock links={{"nemo_rl.data.interfaces.LLMMessageLogType":"/nemo-rl/nemo_rl/data/interfaces#nemo_rl-data-interfaces-LLMMessageLogType","nemo_rl.environments.code_environment.CodeEnvMetadata":"#nemo_rl-environments-code_environment-CodeEnvMetadata","nemo_rl.environments.interfaces.EnvironmentReturn":"/nemo-rl/nemo_rl/environments/interfaces#nemo_rl-environments-interfaces-EnvironmentReturn"}} showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.environments.code_environment.CodeEnvironment.step(
    message_log_batch: typing.List[nemo_rl.data.interfaces.LLMMessageLogType],
    metadata_batch: typing.List[nemo_rl.environments.code_environment.CodeEnvMetadata],
    return_extracted_answer: bool = False
) -> nemo_rl.environments.interfaces.EnvironmentReturn
```

</CodeBlock>
</Anchor>

<Indent>

Process a batch of code execution steps.


</Indent>
</Indent>

<Anchor id="nemo_rl-environments-code_environment-CodeExecutionWorker">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
class nemo_rl.environments.code_environment.CodeExecutionWorker()
```

</CodeBlock>
</Anchor>

<Indent>

Helper class to process individual code execution steps.


<ParamField path="sandbox" type="= &#123;'__builtins__': builtin_dict&#125;">
</ParamField>
<Anchor id="nemo_rl-environments-code_environment-CodeExecutionWorker-chdir">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.environments.code_environment.CodeExecutionWorker.chdir(
    dir: str
)
```

</CodeBlock>
</Anchor>

<Indent>

Change to temporary directory for file operations.


</Indent>
<Anchor id="nemo_rl-environments-code_environment-CodeExecutionWorker-execute">

<CodeBlock links={{"nemo_rl.environments.code_environment.CodeEnvMetadata":"#nemo_rl-environments-code_environment-CodeEnvMetadata"}} showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.environments.code_environment.CodeExecutionWorker.execute(
    message_batch: str,
    metadata_batch: typing.List[nemo_rl.environments.code_environment.CodeEnvMetadata]
) -> typing.Tuple[typing.List[typing.Dict[str, str]], typing.List[bool], typing.List[typing.Any]]
```

</CodeBlock>
</Anchor>

<Indent>

Execute code in a sandboxed environment.


</Indent>
<Anchor id="nemo_rl-environments-code_environment-CodeExecutionWorker-format_result">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.environments.code_environment.CodeExecutionWorker.format_result(
    result: typing.Any,
    code: typing.Optional[str] = None,
    lookahead: typing.Optional[str] = None
) -> str
```

</CodeBlock>
</Anchor>

<Indent>


</Indent>
<Anchor id="nemo_rl-environments-code_environment-CodeExecutionWorker-safe_import">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.environments.code_environment.CodeExecutionWorker.safe_import(
    name: str,
    args = (),
    kwargs = {}
)
```

</CodeBlock>
</Anchor>

<Indent>

Safe version of import that blocks risky modules.


</Indent>
<Anchor id="nemo_rl-environments-code_environment-CodeExecutionWorker-safe_open">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.environments.code_environment.CodeExecutionWorker.safe_open(
    file: str,
    args = (),
    kwargs = {}
)
```

</CodeBlock>
</Anchor>

<Indent>

Safe version of open() that only allows access to temporary directory.


</Indent>
<Anchor id="nemo_rl-environments-code_environment-CodeExecutionWorker-sanitize">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.environments.code_environment.CodeExecutionWorker.sanitize(
    obj: typing.Any
) -> typing.Any
```

</CodeBlock>
</Anchor>

<Indent>


</Indent>
</Indent>
