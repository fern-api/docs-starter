---
layout: overview
slug: nemo-rl/nemo_rl/models/megatron/config
title: nemo_rl.models.megatron.config
---

## Module Contents

### Classes

| Name | Description |
|------|-------------|
| [`MegatronGenerationConfig`](#nemo_rl-models-megatron-config-MegatronGenerationConfig) | - |
| [`ModelAndOptimizerState`](#nemo_rl-models-megatron-config-ModelAndOptimizerState) | Container for model and optimizer state. |
| [`RuntimeConfig`](#nemo_rl-models-megatron-config-RuntimeConfig) | Runtime configuration for model training and inference. |

### API

<Anchor id="nemo_rl-models-megatron-config-MegatronGenerationConfig">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
class nemo_rl.models.megatron.config.MegatronGenerationConfig
```

</CodeBlock>
</Anchor>

<Indent>

**Bases:** `typing.TypedDict`

<ParamField path="block_size_tokens" type="int">

</ParamField>

<ParamField path="buffer_guaranteed_fraction" type="float">

</ParamField>

<ParamField path="buffer_size_gb" type="int">

</ParamField>

<ParamField path="enable_chunked_prefill" type="bool">

</ParamField>

<ParamField path="max_tokens" type="int">

</ParamField>

<ParamField path="num_cuda_graphs" type="int">

</ParamField>

<ParamField path="unified_memory_level" type="int">

</ParamField>

<ParamField path="use_cuda_graphs_for_non_decode_steps" type="bool">

</ParamField>

</Indent>

<Anchor id="nemo_rl-models-megatron-config-ModelAndOptimizerState">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
class nemo_rl.models.megatron.config.ModelAndOptimizerState()
```

</CodeBlock>
</Anchor>

<Indent>

**Bases:** `NamedTuple`

Container for model and optimizer state.

This named tuple holds all model-related state including the model itself,
optimizer, scheduler, and metadata about the model type and configuration.


<ParamField path="checkpointing_context" type="dict[str, Any]">
</ParamField>

<ParamField path="model" type="MegatronModule">
</ParamField>

<ParamField path="optimizer" type="MegatronOptimizer">
</ParamField>

<ParamField path="param_sync_func" type="Optional[Callable]">
</ParamField>

<ParamField path="scheduler" type="OptimizerParamScheduler">
</ParamField>

<ParamField path="state" type="GlobalState">
</ParamField>
</Indent>

<Anchor id="nemo_rl-models-megatron-config-RuntimeConfig">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
class nemo_rl.models.megatron.config.RuntimeConfig()
```

</CodeBlock>
</Anchor>

<Indent>

**Bases:** `NamedTuple`

Runtime configuration for model training and inference.

This contains all validated runtime settings needed for model initialization,
parallelization, and training.


<ParamField path="dtype" type="dtype">
</ParamField>

<ParamField path="final_padded_vocab_size" type="int">
</ParamField>

<ParamField path="is_generation_colocated" type="Optional[bool]">
</ParamField>

<ParamField path="megatron_cfg" type="ConfigContainer">
</ParamField>

<ParamField path="offload_optimizer_for_logprob" type="bool">
</ParamField>

<ParamField path="optimizer_cpu_offload" type="bool">
</ParamField>
</Indent>
