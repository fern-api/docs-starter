---
layout: overview
slug: nemo-rl/nemo_rl/algorithms/rm
title: nemo_rl.algorithms.rm
---

## Module Contents

### Classes

| Name | Description |
|------|-------------|
| [`MasterConfig`](#nemo_rl-algorithms-rm-MasterConfig) | - |
| [`RMConfig`](#nemo_rl-algorithms-rm-RMConfig) | - |
| [`RMSaveState`](#nemo_rl-algorithms-rm-RMSaveState) | - |
| [`RMValMetrics`](#nemo_rl-algorithms-rm-RMValMetrics) | - |

### Functions

| Name | Description |
|------|-------------|
| [`_default_rm_save_state`](#nemo_rl-algorithms-rm-_default_rm_save_state) | - |
| [`rm_train`](#nemo_rl-algorithms-rm-rm_train) | - |
| [`setup`](#nemo_rl-algorithms-rm-setup) | Main entry point for running RM algorithm. |
| [`validate`](#nemo_rl-algorithms-rm-validate) | - |
| [`validate_one_dataset`](#nemo_rl-algorithms-rm-validate_one_dataset) | Run validation on one validation dataset. |

### API

<Anchor id="nemo_rl-algorithms-rm-MasterConfig">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
class nemo_rl.algorithms.rm.MasterConfig
```

</CodeBlock>
</Anchor>

<Indent>

**Bases:** `typing.TypedDict`

<ParamField path="checkpointing" type="CheckpointingConfig">

</ParamField>

<ParamField path="cluster" type="ClusterConfig">

</ParamField>

<ParamField path="data" type="DataConfig">

</ParamField>

<ParamField path="logger" type="LoggerConfig">

</ParamField>

<ParamField path="policy" type="PolicyConfig">

</ParamField>

<ParamField path="rm" type="RMConfig">

</ParamField>

</Indent>

<Anchor id="nemo_rl-algorithms-rm-RMConfig">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
class nemo_rl.algorithms.rm.RMConfig
```

</CodeBlock>
</Anchor>

<Indent>

**Bases:** `typing.TypedDict`

<ParamField path="max_num_epochs" type="int">

</ParamField>

<ParamField path="max_num_steps" type="int">

</ParamField>

<ParamField path="seed" type="int">

</ParamField>

<ParamField path="val_at_end" type="bool">

</ParamField>

<ParamField path="val_at_start" type="bool">

</ParamField>

<ParamField path="val_batches" type="int">

</ParamField>

<ParamField path="val_global_batch_size" type="int">

</ParamField>

<ParamField path="val_micro_batch_size" type="int">

</ParamField>

<ParamField path="val_period" type="int">

</ParamField>

</Indent>

<Anchor id="nemo_rl-algorithms-rm-RMSaveState">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
class nemo_rl.algorithms.rm.RMSaveState
```

</CodeBlock>
</Anchor>

<Indent>

**Bases:** `typing.TypedDict`

<ParamField path="consumed_samples" type="int">

</ParamField>

<ParamField path="epoch" type="int">

</ParamField>

<ParamField path="step" type="int">

</ParamField>

<ParamField path="total_steps" type="int">

</ParamField>

<ParamField path="total_valid_tokens" type="int">

</ParamField>

</Indent>

<Anchor id="nemo_rl-algorithms-rm-RMValMetrics">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
class nemo_rl.algorithms.rm.RMValMetrics
```

</CodeBlock>
</Anchor>

<Indent>

**Bases:** `typing.TypedDict`

<ParamField path="accuracy" type="float">

</ParamField>

<ParamField path="loss" type="float">

</ParamField>

<ParamField path="num_valid_samples" type="float">

</ParamField>

<ParamField path="rewards_chosen_mean" type="float">

</ParamField>

<ParamField path="rewards_rejected_mean" type="float">

</ParamField>

</Indent>

<Anchor id="nemo_rl-algorithms-rm-_default_rm_save_state">

<CodeBlock links={{"nemo_rl.algorithms.rm.RMSaveState":"#nemo_rl-algorithms-rm-RMSaveState"}} showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.algorithms.rm._default_rm_save_state() -> nemo_rl.algorithms.rm.RMSaveState
```

</CodeBlock>
</Anchor>

<Indent>


</Indent>

<Anchor id="nemo_rl-algorithms-rm-rm_train">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.algorithms.rm.rm_train(
    policy,
    train_dataloader,
    val_dataloader,
    tokenizer,
    loss_fn,
    master_config,
    logger,
    checkpointer,
    rm_save_state
)
```

</CodeBlock>
</Anchor>

<Indent>


</Indent>

<Anchor id="nemo_rl-algorithms-rm-setup">

<CodeBlock links={{"nemo_rl.algorithms.rm.MasterConfig":"#nemo_rl-algorithms-rm-MasterConfig","nemo_rl.data.datasets.AllTaskProcessedDataset":"/nemo-rl/nemo_rl/data/datasets/processed_dataset#nemo_rl-data-datasets-processed_dataset-AllTaskProcessedDataset","nemo_rl.models.policy.lm_policy.Policy":"/nemo-rl/nemo_rl/models/policy/lm_policy#nemo_rl-models-policy-lm_policy-Policy","nemo_rl.distributed.virtual_cluster.RayVirtualCluster":"/nemo-rl/nemo_rl/distributed/virtual_cluster#nemo_rl-distributed-virtual_cluster-RayVirtualCluster","nemo_rl.algorithms.loss_functions.PreferenceLoss":"/nemo-rl/nemo_rl/algorithms/loss_functions#nemo_rl-algorithms-loss_functions-PreferenceLoss","nemo_rl.utils.logger.Logger":"/nemo-rl/nemo_rl/utils/logger#nemo_rl-utils-logger-Logger","nemo_rl.data.interfaces.TaskDataSpec":"/nemo-rl/nemo_rl/data/interfaces#nemo_rl-data-interfaces-TaskDataSpec","nemo_rl.algorithms.rm.RMSaveState":"#nemo_rl-algorithms-rm-RMSaveState"}} showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.algorithms.rm.setup(
    master_config: nemo_rl.algorithms.rm.MasterConfig,
    tokenizer: transformers.AutoTokenizer,
    train_dataset: nemo_rl.data.datasets.AllTaskProcessedDataset,
    val_dataset: dict[str, nemo_rl.data.datasets.AllTaskProcessedDataset]
) -> tuple[nemo_rl.models.policy.lm_policy.Policy, nemo_rl.distributed.virtual_cluster.RayVirtualCluster, torchdata.stateful_dataloader.StatefulDataLoader, dict[str, torchdata.stateful_dataloader.StatefulDataLoader], nemo_rl.algorithms.loss_functions.PreferenceLoss, nemo_rl.algorithms.rm.MasterConfig, nemo_rl.utils.logger.Logger, nemo_rl.data.interfaces.TaskDataSpec, nemo_rl.algorithms.rm.RMSaveState]
```

</CodeBlock>
</Anchor>

<Indent>

Main entry point for running RM algorithm.

**Returns:** `tuple[Policy, RayVirtualCluster, StatefulDataLoader, dict[str, StatefulDataLoader], PreferenceLoss, MasterConfig, Logger, TaskDataSpec, RMSaveState]`

Tuple of policy, cluster, dataloader, tokenizer, loss_fn, math_env, master_config, logger


</Indent>

<Anchor id="nemo_rl-algorithms-rm-validate">

<CodeBlock links={{"nemo_rl.models.policy.interfaces.PolicyInterface":"/nemo-rl/nemo_rl/models/policy/interfaces#nemo_rl-models-policy-interfaces-PolicyInterface","nemo_rl.algorithms.rm.MasterConfig":"#nemo_rl-algorithms-rm-MasterConfig","nemo_rl.utils.logger.Logger":"/nemo-rl/nemo_rl/utils/logger#nemo_rl-utils-logger-Logger"}} showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.algorithms.rm.validate(
    policy: nemo_rl.models.policy.interfaces.PolicyInterface,
    val_dataloader: dict[str, torchdata.stateful_dataloader.StatefulDataLoader],
    tokenizer,
    loss_fn,
    step: int,
    master_config: nemo_rl.algorithms.rm.MasterConfig,
    val_batches: int,
    val_batch_size: int,
    val_mbs: int,
    logger: nemo_rl.utils.logger.Logger
)
```

</CodeBlock>
</Anchor>

<Indent>


</Indent>

<Anchor id="nemo_rl-algorithms-rm-validate_one_dataset">

<CodeBlock links={{"nemo_rl.models.policy.interfaces.PolicyInterface":"/nemo-rl/nemo_rl/models/policy/interfaces#nemo_rl-models-policy-interfaces-PolicyInterface","nemo_rl.algorithms.rm.MasterConfig":"#nemo_rl-algorithms-rm-MasterConfig"}} showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.algorithms.rm.validate_one_dataset(
    policy: nemo_rl.models.policy.interfaces.PolicyInterface,
    val_dataloader: torchdata.stateful_dataloader.StatefulDataLoader,
    loss_fn,
    step: int,
    master_config: nemo_rl.algorithms.rm.MasterConfig,
    val_batches: int,
    val_batch_size: int,
    val_mbs: int,
    dataset_name: str
)
```

</CodeBlock>
</Anchor>

<Indent>

Run validation on one validation dataset.


</Indent>
