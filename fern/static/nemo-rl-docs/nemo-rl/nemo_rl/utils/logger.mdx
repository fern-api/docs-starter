---
layout: overview
slug: nemo-rl/nemo_rl/utils/logger
title: nemo_rl.utils.logger
---

## Module Contents

### Classes

| Name | Description |
|------|-------------|
| [`GPUMonitoringConfig`](#nemo_rl-utils-logger-GPUMonitoringConfig) | - |
| [`GpuMetricSnapshot`](#nemo_rl-utils-logger-GpuMetricSnapshot) | - |
| [`Logger`](#nemo_rl-utils-logger-Logger) | Main logger class that delegates to multiple backend loggers. |
| [`LoggerConfig`](#nemo_rl-utils-logger-LoggerConfig) | - |
| [`LoggerInterface`](#nemo_rl-utils-logger-LoggerInterface) | Abstract base class for logger backends. |
| [`MLflowConfig`](#nemo_rl-utils-logger-MLflowConfig) | - |
| [`MLflowLogger`](#nemo_rl-utils-logger-MLflowLogger) | MLflow logger backend. |
| [`RayGpuMonitorLogger`](#nemo_rl-utils-logger-RayGpuMonitorLogger) | Monitor GPU utilization across a Ray cluster and log metrics to a parent logger. |
| [`SwanlabConfig`](#nemo_rl-utils-logger-SwanlabConfig) | - |
| [`SwanlabLogger`](#nemo_rl-utils-logger-SwanlabLogger) | SwanLab logger backend. |
| [`TensorboardConfig`](#nemo_rl-utils-logger-TensorboardConfig) | - |
| [`TensorboardLogger`](#nemo_rl-utils-logger-TensorboardLogger) | Tensorboard logger backend. |
| [`WandbConfig`](#nemo_rl-utils-logger-WandbConfig) | - |
| [`WandbLogger`](#nemo_rl-utils-logger-WandbLogger) | Weights & Biases logger backend. |

### Functions

| Name | Description |
|------|-------------|
| [`configure_rich_logging`](#nemo_rl-utils-logger-configure_rich_logging) | Configure rich logging for more visually appealing log output. |
| [`flatten_dict`](#nemo_rl-utils-logger-flatten_dict) | Flatten a nested dictionary. |
| [`get_next_experiment_dir`](#nemo_rl-utils-logger-get_next_experiment_dir) | Create a new experiment directory with an incremented ID. |
| [`print_message_log_samples`](#nemo_rl-utils-logger-print_message_log_samples) | Visualization for message logs and rewards using a more visual approach with emoji indicators and horizontal layout. |

### Data

[`_rich_logging_configured`](#nemo_rl-utils-logger-_rich_logging_configured)

### API

<Anchor id="nemo_rl-utils-logger-GPUMonitoringConfig">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
class nemo_rl.utils.logger.GPUMonitoringConfig
```

</CodeBlock>
</Anchor>

<Indent>

**Bases:** `typing.TypedDict`

<ParamField path="collection_interval" type="int | float">

</ParamField>

<ParamField path="flush_interval" type="int | float">

</ParamField>

</Indent>

<Anchor id="nemo_rl-utils-logger-GpuMetricSnapshot">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
class nemo_rl.utils.logger.GpuMetricSnapshot
```

</CodeBlock>
</Anchor>

<Indent>

**Bases:** `typing.TypedDict`

<ParamField path="metrics" type="dict[str, Any]">

</ParamField>

<ParamField path="step" type="int">

</ParamField>

</Indent>

<Anchor id="nemo_rl-utils-logger-Logger">

<CodeBlock links={{"nemo_rl.utils.logger.LoggerConfig":"#nemo_rl-utils-logger-LoggerConfig"}} showLineNumbers={false} wordWrap={true}>

```python
class nemo_rl.utils.logger.Logger(
    cfg: nemo_rl.utils.logger.LoggerConfig
)
```

</CodeBlock>
</Anchor>

<Indent>

**Bases:** [LoggerInterface](#nemo_rl-utils-logger-LoggerInterface)

Main logger class that delegates to multiple backend loggers.


<ParamField path="base_log_dir" type="= cfg['log_dir']">
</ParamField>

<ParamField path="loggers" type="list[LoggerInterface] = []">
</ParamField>
<Anchor id="nemo_rl-utils-logger-Logger-__del__">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.utils.logger.Logger.__del__() -> None
```

</CodeBlock>
</Anchor>

<Indent>

Clean up resources when the logger is destroyed.


</Indent>
<Anchor id="nemo_rl-utils-logger-Logger-log_batched_dict_as_jsonl">

<CodeBlock links={{"nemo_rl.distributed.batched_data_dict.BatchedDataDict":"/nemo-rl/nemo_rl/distributed/batched_data_dict#nemo_rl-distributed-batched_data_dict-BatchedDataDict"}} showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.utils.logger.Logger.log_batched_dict_as_jsonl(
    to_log: nemo_rl.distributed.batched_data_dict.BatchedDataDict[typing.Any] | dict[str, typing.Any],
    filename: str
) -> None
```

</CodeBlock>
</Anchor>

<Indent>

Log a list of dictionaries to a JSONL file.

**Parameters:**

<ParamField path="to_log" type="BatchedDataDict[Any] | dict[str, Any]">
BatchedDataDict to log
</ParamField>

<ParamField path="filename" type="str">
Filename to log to (within the log directory)
</ParamField>


</Indent>
<Anchor id="nemo_rl-utils-logger-Logger-log_histogram">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.utils.logger.Logger.log_histogram(
    histogram: list[typing.Any],
    step: int,
    name: str
) -> None
```

</CodeBlock>
</Anchor>

<Indent>

Log histogram metrics to all backends if available.

**Parameters:**

<ParamField path="histogram" type="list[Any]">
List of histogram values
</ParamField>

<ParamField path="step" type="int">
Global step value
</ParamField>

<ParamField path="name" type="str">
Name of the metric
</ParamField>


</Indent>
<Anchor id="nemo_rl-utils-logger-Logger-log_hyperparams">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.utils.logger.Logger.log_hyperparams(
    params: typing.Mapping[str, typing.Any]
) -> None
```

</CodeBlock>
</Anchor>

<Indent>

Log hyperparameters to all enabled backends.

**Parameters:**

<ParamField path="params" type="Mapping[str, Any]">
Dict of hyperparameters to log
</ParamField>


</Indent>
<Anchor id="nemo_rl-utils-logger-Logger-log_metrics">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.utils.logger.Logger.log_metrics(
    metrics: dict[str, typing.Any],
    step: int,
    prefix: typing.Optional[str] = '',
    step_metric: typing.Optional[str] = None,
    step_finished: bool = False
) -> None
```

</CodeBlock>
</Anchor>

<Indent>

Log metrics to all enabled backends.

**Parameters:**

<ParamField path="metrics" type="dict[str, Any]">
Dict of metrics to log
</ParamField>

<ParamField path="step" type="int">
Global step value
</ParamField>

<ParamField path="prefix" type="Optional[str]" default="''">
Optional prefix for metric names
</ParamField>

<ParamField path="step_metric" type="Optional[str]" default="None">
Optional name of a field in metrics to use as step instead
         of the provided step value (currently only needed for wandb)
</ParamField>


</Indent>
<Anchor id="nemo_rl-utils-logger-Logger-log_plot">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.utils.logger.Logger.log_plot(
    figure: matplotlib.pyplot.Figure,
    step: int,
    name: str
) -> None
```

</CodeBlock>
</Anchor>

<Indent>

Log a matplotlib figure to all backends.

**Parameters:**

<ParamField path="figure" type="plt.Figure">
Matplotlib figure to log
</ParamField>

<ParamField path="step" type="int">
Global step value
</ParamField>

<ParamField path="name" type="str">
Name of the plot
</ParamField>


</Indent>
<Anchor id="nemo_rl-utils-logger-Logger-log_plot_per_worker_timeline_metrics">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.utils.logger.Logger.log_plot_per_worker_timeline_metrics(
    metrics: dict[int, list[typing.Any]],
    step: int,
    prefix: str,
    name: str,
    timeline_interval: float
) -> None
```

</CodeBlock>
</Anchor>

<Indent>

Log a plot of per-worker timeline metrics.

**Parameters:**

<ParamField path="metrics" type="dict[int, list[Any]]">
Dictionary of metrics to log, where the keys are the worker IDs and the values are the lists of metric values
</ParamField>

<ParamField path="- metrics">
dict[str, list[Any]] = &#123;worker_id: [metric_value_1, metric_value_2, ...]&#125;
</ParamField>

<ParamField path="step" type="int">
Global step value
</ParamField>

<ParamField path="name" type="str">
Name of the plot
</ParamField>

<ParamField path="timeline_interval" type="float">
Interval between timeline points (in seconds)
</ParamField>


</Indent>
<Anchor id="nemo_rl-utils-logger-Logger-log_plot_token_mult_prob_error">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.utils.logger.Logger.log_plot_token_mult_prob_error(
    data: dict[str, typing.Any],
    step: int,
    name: str
) -> None
```

</CodeBlock>
</Anchor>

<Indent>

Log a plot of log probability errors in samples.

This function logs & plots the per-token log-probabilities and errors over the sequence
for the sample with the highest multiplicative probability error in the batch.

**Parameters:**

<ParamField path="log_data">
Dictionary of log probability samples
</ParamField>

<ParamField path="step" type="int">
Global step value
</ParamField>

<ParamField path="name" type="str">
Name of the plot
</ParamField>


</Indent>
<Anchor id="nemo_rl-utils-logger-Logger-log_string_list_as_jsonl">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.utils.logger.Logger.log_string_list_as_jsonl(
    to_log: list[str],
    filename: str
) -> None
```

</CodeBlock>
</Anchor>

<Indent>

Log a list of strings to a JSONL file.

**Parameters:**

<ParamField path="to_log" type="list[str]">
list of strings to log
</ParamField>

<ParamField path="filename" type="str">
Filename to log to (within the log directory)
</ParamField>


</Indent>
</Indent>

<Anchor id="nemo_rl-utils-logger-LoggerConfig">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
class nemo_rl.utils.logger.LoggerConfig
```

</CodeBlock>
</Anchor>

<Indent>

**Bases:** `typing.TypedDict`

<ParamField path="gpu_monitoring" type="GPUMonitoringConfig">

</ParamField>

<ParamField path="log_dir" type="str">

</ParamField>

<ParamField path="mlflow" type="NotRequired[MLflowConfig]">

</ParamField>

<ParamField path="mlflow_enabled" type="bool">

</ParamField>

<ParamField path="monitor_gpus" type="bool">

</ParamField>

<ParamField path="num_val_samples_to_print" type="NotRequired[int]">

</ParamField>

<ParamField path="swanlab" type="NotRequired[SwanlabConfig]">

</ParamField>

<ParamField path="swanlab_enabled" type="bool">

</ParamField>

<ParamField path="tensorboard" type="NotRequired[TensorboardConfig]">

</ParamField>

<ParamField path="tensorboard_enabled" type="bool">

</ParamField>

<ParamField path="wandb" type="WandbConfig">

</ParamField>

<ParamField path="wandb_enabled" type="bool">

</ParamField>

</Indent>

<Anchor id="nemo_rl-utils-logger-LoggerInterface">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
class nemo_rl.utils.logger.LoggerInterface()
```

</CodeBlock>
</Anchor>

<Indent>

<Badge>Abstract</Badge>

Abstract base class for logger backends.


<Anchor id="nemo_rl-utils-logger-LoggerInterface-log_histogram">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.utils.logger.LoggerInterface.log_histogram(
    histogram: list[typing.Any],
    step: int,
    name: str
) -> None
```

</CodeBlock>
</Anchor>

<Indent>

<Badge>abstract</Badge>

Log histogram metrics.


</Indent>
<Anchor id="nemo_rl-utils-logger-LoggerInterface-log_hyperparams">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.utils.logger.LoggerInterface.log_hyperparams(
    params: typing.Mapping[str, typing.Any]
) -> None
```

</CodeBlock>
</Anchor>

<Indent>

<Badge>abstract</Badge>

Log dictionary of hyperparameters.


</Indent>
<Anchor id="nemo_rl-utils-logger-LoggerInterface-log_metrics">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.utils.logger.LoggerInterface.log_metrics(
    metrics: dict[str, typing.Any],
    step: int,
    prefix: typing.Optional[str] = '',
    step_metric: typing.Optional[str] = None,
    step_finished: bool = False
) -> None
```

</CodeBlock>
</Anchor>

<Indent>

<Badge>abstract</Badge>

Log a dictionary of metrics.


</Indent>
<Anchor id="nemo_rl-utils-logger-LoggerInterface-log_plot">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.utils.logger.LoggerInterface.log_plot(
    figure: matplotlib.pyplot.Figure,
    step: int,
    name: str
) -> None
```

</CodeBlock>
</Anchor>

<Indent>

<Badge>abstract</Badge>

Log a matplotlib figure.


</Indent>
</Indent>

<Anchor id="nemo_rl-utils-logger-MLflowConfig">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
class nemo_rl.utils.logger.MLflowConfig
```

</CodeBlock>
</Anchor>

<Indent>

**Bases:** `typing.TypedDict`

<ParamField path="artifact_location" type="NotRequired[str | None]">

</ParamField>

<ParamField path="experiment_name" type="NotRequired[str | None]">

</ParamField>

<ParamField path="run_id" type="NotRequired[str | None]">

</ParamField>

<ParamField path="run_name" type="NotRequired[str | None]">

</ParamField>

<ParamField path="tracking_uri" type="NotRequired[str | None]">

</ParamField>

</Indent>

<Anchor id="nemo_rl-utils-logger-MLflowLogger">

<CodeBlock links={{"nemo_rl.utils.logger.MLflowConfig":"#nemo_rl-utils-logger-MLflowConfig"}} showLineNumbers={false} wordWrap={true}>

```python
class nemo_rl.utils.logger.MLflowLogger(
    cfg: nemo_rl.utils.logger.MLflowConfig,
    log_dir: typing.Optional[str] = None
)
```

</CodeBlock>
</Anchor>

<Indent>

**Bases:** [LoggerInterface](#nemo_rl-utils-logger-LoggerInterface)

MLflow logger backend.


<ParamField path="run_id" type="= run.info.run_id">
</ParamField>
<Anchor id="nemo_rl-utils-logger-MLflowLogger-__del__">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.utils.logger.MLflowLogger.__del__() -> None
```

</CodeBlock>
</Anchor>

<Indent>

Clean up resources when the logger is destroyed.


</Indent>
<Anchor id="nemo_rl-utils-logger-MLflowLogger-log_histogram">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.utils.logger.MLflowLogger.log_histogram(
    histogram: list[typing.Any],
    step: int,
    name: str
) -> None
```

</CodeBlock>
</Anchor>

<Indent>

Log histogram metrics to MLflow.


</Indent>
<Anchor id="nemo_rl-utils-logger-MLflowLogger-log_hyperparams">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.utils.logger.MLflowLogger.log_hyperparams(
    params: typing.Mapping[str, typing.Any]
) -> None
```

</CodeBlock>
</Anchor>

<Indent>

Log hyperparameters to MLflow.

**Parameters:**

<ParamField path="params" type="Mapping[str, Any]">
Dictionary of hyperparameters to log
</ParamField>


</Indent>
<Anchor id="nemo_rl-utils-logger-MLflowLogger-log_metrics">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.utils.logger.MLflowLogger.log_metrics(
    metrics: dict[str, typing.Any],
    step: int,
    prefix: typing.Optional[str] = '',
    step_metric: typing.Optional[str] = None,
    step_finished: bool = False
) -> None
```

</CodeBlock>
</Anchor>

<Indent>

Log metrics to MLflow.

**Parameters:**

<ParamField path="metrics" type="dict[str, Any]">
Dict of metrics to log
</ParamField>

<ParamField path="step" type="int">
Global step value
</ParamField>

<ParamField path="prefix" type="Optional[str]" default="''">
Optional prefix for metric names
</ParamField>

<ParamField path="step_metric" type="Optional[str]" default="None">
Optional step metric name (ignored in MLflow)
</ParamField>


</Indent>
<Anchor id="nemo_rl-utils-logger-MLflowLogger-log_plot">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.utils.logger.MLflowLogger.log_plot(
    figure: matplotlib.pyplot.Figure,
    step: int,
    name: str
) -> None
```

</CodeBlock>
</Anchor>

<Indent>

Log a plot to MLflow.

**Parameters:**

<ParamField path="figure" type="plt.Figure">
Matplotlib figure to log
</ParamField>

<ParamField path="step" type="int">
Global step value
</ParamField>

<ParamField path="name" type="str">
Name of the plot
</ParamField>


</Indent>
</Indent>

<Anchor id="nemo_rl-utils-logger-RayGpuMonitorLogger">

<CodeBlock links={{"nemo_rl.utils.logger.Logger":"#nemo_rl-utils-logger-Logger"}} showLineNumbers={false} wordWrap={true}>

```python
class nemo_rl.utils.logger.RayGpuMonitorLogger(
    collection_interval: int | float,
    flush_interval: int | float,
    metric_prefix: str,
    step_metric: str,
    parent_logger: typing.Optional[nemo_rl.utils.logger.Logger] = None
)
```

</CodeBlock>
</Anchor>

<Indent>

Monitor GPU utilization across a Ray cluster and log metrics to a parent logger.


<ParamField path="collection_thread" type="Optional[Thread] = None">
</ParamField>

<ParamField path="last_flush_time" type="= time.time()">
</ParamField>

<ParamField path="lock" type="= threading.Lock()">
</ParamField>

<ParamField path="metrics_buffer" type="list[GpuMetricSnapshot] = []">
</ParamField>

<ParamField path="start_time" type="float = float('-inf')">
</ParamField>
<Anchor id="nemo_rl-utils-logger-RayGpuMonitorLogger-_collect">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.utils.logger.RayGpuMonitorLogger._collect(
    metrics: bool = False,
    sku: bool = False
) -> dict[str, typing.Any]
```

</CodeBlock>
</Anchor>

<Indent>

Collect GPU metrics from all Ray nodes.

**Returns:** `dict[str, Any]`

Dictionary of collected metrics


</Indent>
<Anchor id="nemo_rl-utils-logger-RayGpuMonitorLogger-_collect_gpu_sku">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.utils.logger.RayGpuMonitorLogger._collect_gpu_sku() -> dict[str, str]
```

</CodeBlock>
</Anchor>

<Indent>

Collect GPU SKU from all Ray nodes.

Note: This is an internal API and users are not expected to call this.

**Returns:** `dict[str, str]`

Dictionary of SKU types on all Ray nodes


</Indent>
<Anchor id="nemo_rl-utils-logger-RayGpuMonitorLogger-_collect_metrics">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.utils.logger.RayGpuMonitorLogger._collect_metrics() -> dict[str, typing.Any]
```

</CodeBlock>
</Anchor>

<Indent>

Collect GPU metrics from all Ray nodes.

**Returns:** `dict[str, Any]`

Dictionary of collected metrics


</Indent>
<Anchor id="nemo_rl-utils-logger-RayGpuMonitorLogger-_collection_loop">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.utils.logger.RayGpuMonitorLogger._collection_loop() -> None
```

</CodeBlock>
</Anchor>

<Indent>

Main collection loop that runs in a separate thread.


</Indent>
<Anchor id="nemo_rl-utils-logger-RayGpuMonitorLogger-_fetch_and_parse_metrics">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.utils.logger.RayGpuMonitorLogger._fetch_and_parse_metrics(
    node_idx: int,
    metric_address: str,
    parser_fn: typing.Callable
)
```

</CodeBlock>
</Anchor>

<Indent>

Fetch metrics from a node and parse GPU metrics.

**Parameters:**

<ParamField path="node_idx" type="int">
Index of the node
</ParamField>

<ParamField path="metric_address" type="str">
Address of the metrics endpoint
</ParamField>

**Returns:**

Dictionary of GPU metrics


</Indent>
<Anchor id="nemo_rl-utils-logger-RayGpuMonitorLogger-_parse_gpu_sku">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.utils.logger.RayGpuMonitorLogger._parse_gpu_sku(
    sample: prometheus_client.samples.Sample,
    node_idx: int
) -> dict[str, str]
```

</CodeBlock>
</Anchor>

<Indent>

Parse a GPU metric sample into a standardized format.

**Parameters:**

<ParamField path="sample" type="Sample">
Prometheus metric sample
</ParamField>

<ParamField path="node_idx" type="int">
Index of the node
</ParamField>

**Returns:** `dict[str, str]`

Dictionary with metric name and value


</Indent>
<Anchor id="nemo_rl-utils-logger-RayGpuMonitorLogger-_parse_metric">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.utils.logger.RayGpuMonitorLogger._parse_metric(
    sample: prometheus_client.samples.Sample,
    node_idx: int
) -> dict[str, typing.Any]
```

</CodeBlock>
</Anchor>

<Indent>

Parse a metric sample into a standardized format.

**Parameters:**

<ParamField path="sample" type="Sample">
Prometheus metric sample
</ParamField>

<ParamField path="node_idx" type="int">
Index of the node
</ParamField>

**Returns:** `dict[str, Any]`

Dictionary with metric name and value


</Indent>
<Anchor id="nemo_rl-utils-logger-RayGpuMonitorLogger-flush">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.utils.logger.RayGpuMonitorLogger.flush() -> None
```

</CodeBlock>
</Anchor>

<Indent>

Flush collected metrics to the parent logger.


</Indent>
<Anchor id="nemo_rl-utils-logger-RayGpuMonitorLogger-start">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.utils.logger.RayGpuMonitorLogger.start() -> None
```

</CodeBlock>
</Anchor>

<Indent>

Start the GPU monitoring thread.


</Indent>
<Anchor id="nemo_rl-utils-logger-RayGpuMonitorLogger-stop">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.utils.logger.RayGpuMonitorLogger.stop() -> None
```

</CodeBlock>
</Anchor>

<Indent>

Stop the GPU monitoring thread.


</Indent>
</Indent>

<Anchor id="nemo_rl-utils-logger-SwanlabConfig">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
class nemo_rl.utils.logger.SwanlabConfig
```

</CodeBlock>
</Anchor>

<Indent>

**Bases:** `typing.TypedDict`

<ParamField path="name" type="NotRequired[str]">

</ParamField>

<ParamField path="project" type="NotRequired[str]">

</ParamField>

</Indent>

<Anchor id="nemo_rl-utils-logger-SwanlabLogger">

<CodeBlock links={{"nemo_rl.utils.logger.SwanlabConfig":"#nemo_rl-utils-logger-SwanlabConfig"}} showLineNumbers={false} wordWrap={true}>

```python
class nemo_rl.utils.logger.SwanlabLogger(
    cfg: nemo_rl.utils.logger.SwanlabConfig,
    log_dir: typing.Optional[str] = None
)
```

</CodeBlock>
</Anchor>

<Indent>

**Bases:** [LoggerInterface](#nemo_rl-utils-logger-LoggerInterface)

SwanLab logger backend.


<ParamField path="run" type="= swanlab.init(**cfg, logdir=log_dir)">
</ParamField>
<Anchor id="nemo_rl-utils-logger-SwanlabLogger-log_histogram">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.utils.logger.SwanlabLogger.log_histogram(
    histogram: list[typing.Any],
    step: int,
    name: str
) -> None
```

</CodeBlock>
</Anchor>

<Indent>

Log histogram metrics to swanlab.


</Indent>
<Anchor id="nemo_rl-utils-logger-SwanlabLogger-log_hyperparams">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.utils.logger.SwanlabLogger.log_hyperparams(
    params: typing.Mapping[str, typing.Any]
) -> None
```

</CodeBlock>
</Anchor>

<Indent>

Update the Swanlab run configuration with the provided hyperparameters.

**Parameters:**

<ParamField path="params" type="Mapping[str, Any]">
Mapping of hyperparameter names to values to store in the run configuration.
</ParamField>


</Indent>
<Anchor id="nemo_rl-utils-logger-SwanlabLogger-log_metrics">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.utils.logger.SwanlabLogger.log_metrics(
    metrics: dict[str, typing.Any],
    step: int,
    prefix: typing.Optional[str] = '',
    step_metric: typing.Optional[str] = None,
    step_finished: bool = False
) -> None
```

</CodeBlock>
</Anchor>

<Indent>

Log metrics to the associated Swanlab run.

**Parameters:**

<ParamField path="metrics" type="dict[str, Any]">
Mapping of metric names to metric values.
</ParamField>

<ParamField path="step" type="int">
Global step value to associate with all logged metrics.
</ParamField>

<ParamField path="prefix" type="Optional[str]" default="''">
Optional prefix applied to metric names; metric names equal to `step_metric` are not prefixed.
</ParamField>

<ParamField path="step_metric" type="Optional[str]" default="None">
Name of a metric that should be excluded from prefixing.
</ParamField>


</Indent>
<Anchor id="nemo_rl-utils-logger-SwanlabLogger-log_plot">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.utils.logger.SwanlabLogger.log_plot(
    figure: matplotlib.pyplot.Figure,
    step: int,
    name: str
) -> None
```

</CodeBlock>
</Anchor>

<Indent>

Log a plot to swanlab.

**Parameters:**

<ParamField path="figure" type="plt.Figure">
Matplotlib figure to log
</ParamField>

<ParamField path="step" type="int">
Global step value
</ParamField>


</Indent>
</Indent>

<Anchor id="nemo_rl-utils-logger-TensorboardConfig">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
class nemo_rl.utils.logger.TensorboardConfig
```

</CodeBlock>
</Anchor>

<Indent>

**Bases:** `typing.TypedDict`

<ParamField path="log_dir" type="NotRequired[str]">

</ParamField>

</Indent>

<Anchor id="nemo_rl-utils-logger-TensorboardLogger">

<CodeBlock links={{"nemo_rl.utils.logger.TensorboardConfig":"#nemo_rl-utils-logger-TensorboardConfig"}} showLineNumbers={false} wordWrap={true}>

```python
class nemo_rl.utils.logger.TensorboardLogger(
    cfg: nemo_rl.utils.logger.TensorboardConfig,
    log_dir: typing.Optional[str] = None
)
```

</CodeBlock>
</Anchor>

<Indent>

**Bases:** [LoggerInterface](#nemo_rl-utils-logger-LoggerInterface)

Tensorboard logger backend.


<ParamField path="writer" type="= SummaryWriter(log_dir=log_dir)">
</ParamField>
<Anchor id="nemo_rl-utils-logger-TensorboardLogger-_coerce_to_scalar">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.utils.logger.TensorboardLogger._coerce_to_scalar(
    value: typing.Any
) -> int | float | bool | str | None
```

</CodeBlock>
</Anchor>

<Indent>

<Badge>staticmethod</Badge>

Coerce a value to a Python scalar for TensorBoard logging.

Returns the coerced value, or None if it can't be converted to a scalar.


</Indent>
<Anchor id="nemo_rl-utils-logger-TensorboardLogger-log_histogram">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.utils.logger.TensorboardLogger.log_histogram(
    histogram: list[typing.Any],
    step: int,
    name: str
) -> None
```

</CodeBlock>
</Anchor>

<Indent>

Log histogram metrics to Tensorboard.


</Indent>
<Anchor id="nemo_rl-utils-logger-TensorboardLogger-log_hyperparams">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.utils.logger.TensorboardLogger.log_hyperparams(
    params: typing.Mapping[str, typing.Any]
) -> None
```

</CodeBlock>
</Anchor>

<Indent>

Log hyperparameters to Tensorboard.

**Parameters:**

<ParamField path="params" type="Mapping[str, Any]">
Dictionary of hyperparameters to log
</ParamField>


</Indent>
<Anchor id="nemo_rl-utils-logger-TensorboardLogger-log_metrics">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.utils.logger.TensorboardLogger.log_metrics(
    metrics: dict[str, typing.Any],
    step: int,
    prefix: typing.Optional[str] = '',
    step_metric: typing.Optional[str] = None,
    step_finished: bool = False
) -> None
```

</CodeBlock>
</Anchor>

<Indent>

Log metrics to Tensorboard.

**Parameters:**

<ParamField path="metrics" type="dict[str, Any]">
Dict of metrics to log
</ParamField>

<ParamField path="step" type="int">
Global step value
</ParamField>

<ParamField path="prefix" type="Optional[str]" default="''">
Optional prefix for metric names
</ParamField>

<ParamField path="step_metric" type="Optional[str]" default="None">
Optional step metric name (ignored in TensorBoard)
</ParamField>


</Indent>
<Anchor id="nemo_rl-utils-logger-TensorboardLogger-log_plot">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.utils.logger.TensorboardLogger.log_plot(
    figure: matplotlib.pyplot.Figure,
    step: int,
    name: str
) -> None
```

</CodeBlock>
</Anchor>

<Indent>

Log a plot to Tensorboard.

**Parameters:**

<ParamField path="plot_data">
Dictionary of plot data
</ParamField>

<ParamField path="step" type="int">
Global step value
</ParamField>


</Indent>
</Indent>

<Anchor id="nemo_rl-utils-logger-WandbConfig">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
class nemo_rl.utils.logger.WandbConfig
```

</CodeBlock>
</Anchor>

<Indent>

**Bases:** `typing.TypedDict`

<ParamField path="name" type="NotRequired[str]">

</ParamField>

<ParamField path="project" type="NotRequired[str]">

</ParamField>

</Indent>

<Anchor id="nemo_rl-utils-logger-WandbLogger">

<CodeBlock links={{"nemo_rl.utils.logger.WandbConfig":"#nemo_rl-utils-logger-WandbConfig"}} showLineNumbers={false} wordWrap={true}>

```python
class nemo_rl.utils.logger.WandbLogger(
    cfg: nemo_rl.utils.logger.WandbConfig,
    log_dir: typing.Optional[str] = None
)
```

</CodeBlock>
</Anchor>

<Indent>

**Bases:** [LoggerInterface](#nemo_rl-utils-logger-LoggerInterface)

Weights & Biases logger backend.


<ParamField path="run" type="= wandb.init(**cfg, dir=log_dir)">
</ParamField>
<Anchor id="nemo_rl-utils-logger-WandbLogger-_log_code">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.utils.logger.WandbLogger._log_code()
```

</CodeBlock>
</Anchor>

<Indent>

Log code that is tracked by git to wandb.

This function gets a list of all files tracked by git in the project root
and manually uploads them to the current wandb run as an artifact.


</Indent>
<Anchor id="nemo_rl-utils-logger-WandbLogger-_log_diffs">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.utils.logger.WandbLogger._log_diffs()
```

</CodeBlock>
</Anchor>

<Indent>

Log git diffs to wandb.

This function captures and logs two types of diffs:
1. Uncommitted changes (working tree diff against HEAD)
2. All changes (including uncommitted) against the main branch

Each diff is saved as a text file in a wandb artifact.


</Indent>
<Anchor id="nemo_rl-utils-logger-WandbLogger-define_metric">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.utils.logger.WandbLogger.define_metric(
    name: str,
    step_metric: typing.Optional[str] = None
) -> None
```

</CodeBlock>
</Anchor>

<Indent>

Define a metric with custom step metric.

**Parameters:**

<ParamField path="name" type="str">
Name of the metric or pattern (e.g. 'ray/*')
</ParamField>

<ParamField path="step_metric" type="Optional[str]" default="None">
Optional name of the step metric to use
</ParamField>


</Indent>
<Anchor id="nemo_rl-utils-logger-WandbLogger-log_histogram">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.utils.logger.WandbLogger.log_histogram(
    histogram: list[typing.Any],
    step: int,
    name: str
) -> None
```

</CodeBlock>
</Anchor>

<Indent>

Log histogram metrics to wandb.

**Parameters:**

<ParamField path="histogram" type="list[Any]">
List of histogram values
</ParamField>

<ParamField path="step" type="int">
Global step value
</ParamField>

<ParamField path="name" type="str">
Name of the metric
</ParamField>


</Indent>
<Anchor id="nemo_rl-utils-logger-WandbLogger-log_hyperparams">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.utils.logger.WandbLogger.log_hyperparams(
    params: typing.Mapping[str, typing.Any]
) -> None
```

</CodeBlock>
</Anchor>

<Indent>

Log hyperparameters to wandb.

**Parameters:**

<ParamField path="params" type="Mapping[str, Any]">
Dict of hyperparameters to log
</ParamField>


</Indent>
<Anchor id="nemo_rl-utils-logger-WandbLogger-log_metrics">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.utils.logger.WandbLogger.log_metrics(
    metrics: dict[str, typing.Any],
    step: int,
    prefix: typing.Optional[str] = '',
    step_metric: typing.Optional[str] = None,
    step_finished: bool = False
) -> None
```

</CodeBlock>
</Anchor>

<Indent>

Log metrics to wandb.

**Parameters:**

<ParamField path="metrics" type="dict[str, Any]">
Dict of metrics to log
</ParamField>

<ParamField path="step" type="int">
Global step value
</ParamField>

<ParamField path="prefix" type="Optional[str]" default="''">
Optional prefix for metric names
</ParamField>

<ParamField path="step_metric" type="Optional[str]" default="None">
Optional name of a field in metrics to use as step instead
         of the provided step value
</ParamField>


</Indent>
<Anchor id="nemo_rl-utils-logger-WandbLogger-log_plot">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.utils.logger.WandbLogger.log_plot(
    figure: matplotlib.pyplot.Figure,
    step: int,
    name: str
) -> None
```

</CodeBlock>
</Anchor>

<Indent>

Log a plot to wandb.

**Parameters:**

<ParamField path="figure" type="plt.Figure">
Matplotlib figure to log
</ParamField>

<ParamField path="step" type="int">
Global step value
</ParamField>


</Indent>
</Indent>

<Anchor id="nemo_rl-utils-logger-configure_rich_logging">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.utils.logger.configure_rich_logging(
    level: str = 'INFO',
    show_time: bool = True,
    show_path: bool = True
) -> None
```

</CodeBlock>
</Anchor>

<Indent>

Configure rich logging for more visually appealing log output.

**Parameters:**

<ParamField path="level" type="str" default="'INFO'">
The logging level to use
</ParamField>

<ParamField path="show_time" type="bool" default="True">
Whether to show timestamps in logs
</ParamField>

<ParamField path="show_path" type="bool" default="True">
Whether to show file paths in logs
</ParamField>


</Indent>

<Anchor id="nemo_rl-utils-logger-flatten_dict">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.utils.logger.flatten_dict(
    d: typing.Mapping[str, typing.Any],
    sep: str = '.'
) -> dict[str, typing.Any]
```

</CodeBlock>
</Anchor>

<Indent>

Flatten a nested dictionary.

Handles nested dictionaries and lists by creating keys with separators.
For lists, the index is used as part of the key.

**Parameters:**

<ParamField path="d" type="Mapping[str, Any]">
Dictionary to flatten
</ParamField>

<ParamField path="sep" type="str" default="'.'">
Separator to use between nested keys
</ParamField>

**Returns:** `dict[str, Any]`

Flattened dictionary with compound keys

**Examples:**

<CodeBlock showLineNumbers={false}>

```python
>>> from nemo_rl.utils.logger import flatten_dict
>>> flatten_dict({"a": 1, "b": {"c": 2}})
{'a': 1, 'b.c': 2}

>>> flatten_dict({"a": [1, 2], "b": {"c": [3, 4]}})
{'a.0': 1, 'a.1': 2, 'b.c.0': 3, 'b.c.1': 4}

>>> flatten_dict({"a": [{"b": 1}, {"c": 2}]})
{'a.0.b': 1, 'a.1.c': 2}
```

</CodeBlock>


</Indent>

<Anchor id="nemo_rl-utils-logger-get_next_experiment_dir">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.utils.logger.get_next_experiment_dir(
    base_log_dir: str
) -> str
```

</CodeBlock>
</Anchor>

<Indent>

Create a new experiment directory with an incremented ID.

**Parameters:**

<ParamField path="base_log_dir" type="str">
The base log directory path
</ParamField>

**Returns:** `str`

Path to the new experiment directory with incremented ID


</Indent>

<Anchor id="nemo_rl-utils-logger-print_message_log_samples">

<CodeBlock links={{"nemo_rl.data.interfaces.LLMMessageLogType":"/nemo-rl/nemo_rl/data/interfaces#nemo_rl-data-interfaces-LLMMessageLogType"}} showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.utils.logger.print_message_log_samples(
    message_logs: list[nemo_rl.data.interfaces.LLMMessageLogType],
    rewards: list[float],
    num_samples: int = 5,
    step: int = 0
) -> None
```

</CodeBlock>
</Anchor>

<Indent>

Visualization for message logs and rewards using a more visual approach with emoji indicators and horizontal layout.

**Parameters:**

<ParamField path="message_logs" type="list[LLMMessageLogType]">
List of message logs to sample from
</ParamField>

<ParamField path="rewards" type="list[float]">
List of rewards corresponding to each message log
</ParamField>

<ParamField path="num_samples" type="int" default="5">
Number of samples to display (default: 5)
</ParamField>

<ParamField path="step" type="int" default="0">
Current training step (for display purposes)
</ParamField>


</Indent>

<Anchor id="nemo_rl-utils-logger-_rich_logging_configured">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.utils.logger._rich_logging_configured = False
```

</CodeBlock>
</Anchor>

