---
layout: overview
slug: nemo-rl/nemo_rl/utils/packed_tensor
title: nemo_rl.utils.packed_tensor
---

## Module Contents

### Functions

| Name | Description |
|------|-------------|
| [`get_num_buffers`](#nemo_rl-utils-packed_tensor-get_num_buffers) | - |
| [`get_target_packed_tensor_size`](#nemo_rl-utils-packed_tensor-get_target_packed_tensor_size) | - |
| [`packed_broadcast_consumer`](#nemo_rl-utils-packed_tensor-packed_broadcast_consumer) | Consume a packed tensor and unpack it into a list of tensors. |
| [`packed_broadcast_producer`](#nemo_rl-utils-packed_tensor-packed_broadcast_producer) | Broadcast a list of tensors in a packed manner. |

### API

<Anchor id="nemo_rl-utils-packed_tensor-get_num_buffers">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.utils.packed_tensor.get_num_buffers()
```

</CodeBlock>
</Anchor>

<Indent>


</Indent>

<Anchor id="nemo_rl-utils-packed_tensor-get_target_packed_tensor_size">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.utils.packed_tensor.get_target_packed_tensor_size()
```

</CodeBlock>
</Anchor>

<Indent>


</Indent>

<Anchor id="nemo_rl-utils-packed_tensor-packed_broadcast_consumer">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.utils.packed_tensor.packed_broadcast_consumer(
    iterator,
    group,
    src,
    post_unpack_func
)
```

</CodeBlock>
</Anchor>

<Indent>

Consume a packed tensor and unpack it into a list of tensors.

**Parameters:**

<ParamField path="iterator">
iterator of model parameters. Returns a tuple of (name, tensor)
</ParamField>

<ParamField path="group">
process group (vllm PyNcclCommunicator)
</ParamField>

<ParamField path="src">
source rank (0 in current implementation)
</ParamField>

<ParamField path="post_unpack_func">
function to apply to each tensor after unpacking
</ParamField>

**Returns:**

None


</Indent>

<Anchor id="nemo_rl-utils-packed_tensor-packed_broadcast_producer">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.utils.packed_tensor.packed_broadcast_producer(
    iterator,
    group,
    src,
    post_iter_func
)
```

</CodeBlock>
</Anchor>

<Indent>

Broadcast a list of tensors in a packed manner.

**Parameters:**

<ParamField path="iterator">
iterator of model parameters. Returns a tuple of (name, tensor)
</ParamField>

<ParamField path="group">
process group (vllm PyNcclCommunicator)
</ParamField>

<ParamField path="src">
source rank (0 in current implementation)
</ParamField>

<ParamField path="post_iter_func">
function to apply to each tensor before packing, should return a tensor
</ParamField>

**Returns:**

None


</Indent>
