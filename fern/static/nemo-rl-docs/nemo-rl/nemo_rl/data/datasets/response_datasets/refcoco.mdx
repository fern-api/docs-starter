---
layout: overview
slug: nemo-rl/nemo_rl/data/datasets/response_datasets/refcoco
title: nemo_rl.data.datasets.response_datasets.refcoco
---

## Module Contents

### Classes

| Name | Description |
|------|-------------|
| [`RefCOCODataset`](#nemo_rl-data-datasets-response_datasets-refcoco-RefCOCODataset) | Simple wrapper around the RefCOCO dataset. |

### Functions

| Name | Description |
|------|-------------|
| [`download_and_unzip`](#nemo_rl-data-datasets-response_datasets-refcoco-download_and_unzip) | Downloads a zip file from a given URL to a target directory and unzips it into a specified subdirectory within the target directory, showing download progress. |
| [`format_refcoco_dataset`](#nemo_rl-data-datasets-response_datasets-refcoco-format_refcoco_dataset) | Format the RefCOCO dataset from huggingface. |

### API

<Anchor id="nemo_rl-data-datasets-response_datasets-refcoco-RefCOCODataset">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
class nemo_rl.data.datasets.response_datasets.refcoco.RefCOCODataset(
    split: str = 'train',
    download_dir: str = './coco_images',
    kwargs = {}
)
```

</CodeBlock>
</Anchor>

<Indent>

**Bases:** [RawDataset](/nemo-rl/nemo_rl/data/datasets/raw_dataset#nemo_rl-data-datasets-raw_dataset-RawDataset)

Simple wrapper around the RefCOCO dataset.

**Parameters:**

<ParamField path="split" type="str" default="'train'">
Split name for the dataset, default is "train"
</ParamField>

<ParamField path="download_dir" type="str" default="'./coco_images'">
Directory to download the dataset to, default is "./coco_images"
</ParamField>


<ParamField path="dataset" type="= self.dataset.map(self.format_data)">
</ParamField>

<ParamField path="task_name" type="= 'refcoco'">
</ParamField>
<Anchor id="nemo_rl-data-datasets-response_datasets-refcoco-RefCOCODataset-format_data">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.data.datasets.response_datasets.refcoco.RefCOCODataset.format_data(
    data: dict[str, typing.Any]
) -> dict[str, typing.Any]
```

</CodeBlock>
</Anchor>

<Indent>


</Indent>
</Indent>

<Anchor id="nemo_rl-data-datasets-response_datasets-refcoco-download_and_unzip">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.data.datasets.response_datasets.refcoco.download_and_unzip(
    url: str,
    target_directory: str,
    subdir_name: str = '.'
)
```

</CodeBlock>
</Anchor>

<Indent>

Downloads a zip file from a given URL to a target directory and unzips it into a specified subdirectory within the target directory, showing download progress.

**Parameters:**

<ParamField path="url" type="str">
The URL of the zip file to download.
</ParamField>

<ParamField path="target_directory" type="str">
The directory where the zip file will be downloaded
                    and unzipped.
</ParamField>

<ParamField path="subdir_name" type="str" default="'.'">
The name of the subdirectory within the target_directory
               where the contents of the zip file will be unzipped.
               Defaults to "train".
</ParamField>


</Indent>

<Anchor id="nemo_rl-data-datasets-response_datasets-refcoco-format_refcoco_dataset">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.data.datasets.response_datasets.refcoco.format_refcoco_dataset(
    example: dict[str, typing.Any],
    width: int = 256,
    height: int = 256,
    caption_type: str = 'random'
) -> dict[str, typing.Any]
```

</CodeBlock>
</Anchor>

<Indent>

Format the RefCOCO dataset from huggingface.

This should be replaced with our own curated RefCOCO/+/g dataset soon

**Parameters:**

<ParamField path="example" type="dict[str, Any]">
The example to format.
</ParamField>

<ParamField path="width" type="int" default="256">
The width of the resized image.
</ParamField>

<ParamField path="height" type="int" default="256">
The height of the resized image.
</ParamField>

<ParamField path="caption_type" type="str" default="'random'">
The type of caption to use.
</ParamField>


</Indent>
