---
layout: overview
slug: nemo-rl/nemo_rl/data/datasets/preference_datasets/binary_preference_dataset
title: nemo_rl.data.datasets.preference_datasets.binary_preference_dataset
---

## Module Contents

### Classes

| Name | Description |
|------|-------------|
| [`BinaryPreferenceDataset`](#nemo_rl-data-datasets-preference_datasets-binary_preference_dataset-BinaryPreferenceDataset) | Dataset class for binary preference data which can be loaded from a JSON file. |

### API

<Anchor id="nemo_rl-data-datasets-preference_datasets-binary_preference_dataset-BinaryPreferenceDataset">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
class nemo_rl.data.datasets.preference_datasets.binary_preference_dataset.BinaryPreferenceDataset(
    data_path: str,
    prompt_key: str = 'prompt',
    chosen_key: str = 'chosen',
    rejected_key: str = 'rejected',
    subset: typing.Optional[str] = None,
    split: typing.Optional[str] = None,
    kwargs = {}
)
```

</CodeBlock>
</Anchor>

<Indent>

**Bases:** [RawDataset](/nemo-rl/nemo_rl/data/datasets/raw_dataset#nemo_rl-data-datasets-raw_dataset-RawDataset)

Dataset class for binary preference data which can be loaded from a JSON file.

This class handles loading of preference data for DPO and RM training.
It will be converted to the format of PreferenceDataset through the `to_preference_data_format` function.

The input JSONL files should contain valid JSON objects formatted like this:
&#123;
    prompt_key: str,    # The input prompt/context
    chosen_key: str,    # The preferred/winning response
    rejected_key: str,  # The non-preferred/losing response
&#125;
Please refer to https://github.com/NVIDIA-NeMo/RL/blob/main/docs/guides/dpo.md#datasets for more details.

**Parameters:**

<ParamField path="data_path" type="str">
Path to the dataset JSON file
</ParamField>

<ParamField path="prompt_key" type="str" default="'prompt'">
Key for the input prompt/context, default is "prompt"
</ParamField>

<ParamField path="chosen_key" type="str" default="'chosen'">
Key for the preferred/winning response, default is "chosen"
</ParamField>

<ParamField path="rejected_key" type="str" default="'rejected'">
Key for the non-preferred/losing response, default is "rejected"
</ParamField>

<ParamField path="subset" type="Optional[str]" default="None">
Optional subset name for the dataset, used for HuggingFace datasets
</ParamField>

<ParamField path="split" type="Optional[str]" default="None">
Optional split name for the dataset, used for HuggingFace datasets
</ParamField>


<ParamField path="dataset">
</ParamField>

<ParamField path="task_name">
</ParamField>
<Anchor id="nemo_rl-data-datasets-preference_datasets-binary_preference_dataset-BinaryPreferenceDataset-format_data">

<CodeBlock showLineNumbers={false} wordWrap={true}>

```python
nemo_rl.data.datasets.preference_datasets.binary_preference_dataset.BinaryPreferenceDataset.format_data(
    data: dict[str, typing.Any]
) -> dict[str, typing.Any]
```

</CodeBlock>
</Anchor>

<Indent>


</Indent>
</Indent>
